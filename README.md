# Lucky-Admin

## Functional Requirements (Beta) 

### Authentication & Authorization
- Admins must log in to access admin features.
- Clients must register before placing any bets.

### Game Management
- Admins can create a games with a specific closing time.
- Games auto-close at the configured time
- A Game can have multiple rounds and each round contains random numbers generated by the system.

### Bet Management
- Registered clients can place bets for a specific draw.
- Bets must be placed at least 24 hours before the draw closes.
- Admins can manually mark a bet as paid/unpaid (in-person payment, no payment integration).

### Reports & Results
- After a draw closes, the system calculates hits for each bet.
- Admins can generate reports of the top 3 winners based on hits.

---

## Tech Stack

### Back-End
- **Language**: [Go (Golang)](https://go.dev/)
- **API**: REST or gRPC endpoints to handle user auth, bet registration, draw management, and reports
- **Database**: DynamoDB (AWS)
---

## MVP Assumptions

- All bet payments are handled in person ‚Äî no online payment integration is required in the MVP.

## Database

### ‚òÅÔ∏è DynamoDB Table Structure 


| **Partition Key (PK)** | **Sort Key (SK)**                   | **Item Type**  |
| ---------------------- | ----------------------------------- | -------------- |
| `CLIENT#<client_id>`   | `BET#<game_id>#<round_id>#<bet_id>` | Bet            |
| `ROUND#<round_id>`     | `BET#<bet_id>`                      | Bet            |
| `GAME#<game_id>`       | `ROUND#<round_id>`                  | Round          |
| `GAME#<game_id>`       | `BET#<round_id>#<bet_id>`           | Bet (copy)     |
| `GAME#<game_id>`       | `METADATA`                          | Game Metadata  |
| `CLIENT#<client_id>`   | `METADATA`                          | Client Profile |
| `ADMIN#<admin_id>`     | `METADATA`                          | Admin Profile  |

#### The Bets are duplicated under:
- ```ROUND#<round_id>``` -> to get all bets per round
- ```CLIENT#<client_id>```->  to get all bets per client
- ```GAME#<game_id```-> to group all bets in a game (for winner calc)

**üíµ Note:** The data duplication will help to optimize the storage costs.

#### üîÜ NoSQL principles considered for the table design
| Principle                      | Description                                                                 |
|-------------------------------|-----------------------------------------------------------------------------|
| Access-Pattern First Design   | Model based on what you query, not what you store                          |
| Avoid Joins                   | Embed or duplicate related data                                             |
| Minimize Partitions           | Reduce random access across partitions                                      |
| Optimize for Query/Write Costs| Fewer read operations, avoid scans                                          |
| Use Composite Keys            | Use for sorting and grouping related items                                  |

### üî≠ Example Items:

**Client Item** 

```
{
  "PK": "CLIENT#123",
  "SK": "METADATA",
  "fullName": "Alice",
  "birth_date": "1990-01-01",
  "created_at": "2025-01-01T00:00:00Z"
}
```

**Bet Item (Under Client)**

```
{
  "PK": "CLIENT#123",
  "SK": "BET#game1#round2#bet789",
  "round_id": "round2",
  "game_id": "game1",
  "numbers": [5, 9, 22],
  "hits": 2,
  "payment_status": "PAID"
}
```

**Round Item**

```
{
  "PK": "GAME#game1",
  "SK": "ROUND#round2",
  "round_id": "round2",
  "numbers": [5, 9, 22]
}
```

**Bet Item (Under Round)**

```
{
  "PK": "ROUND#round2",
  "SK": "BET#bet789",
  "client_id": "123",
  "numbers": [5, 9, 22],
  "hits": 2,
  "payment_status": "PAID"
}
```

**Bet Item (Under Game)**

```
{
  "PK": "GAME#game1",
  "SK": "BET#round2#bet789",
  "client_id": "123",
  "hits": 2
}
```